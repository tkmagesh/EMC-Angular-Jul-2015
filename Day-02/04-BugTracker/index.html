<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bug Tracker</title>
    <link rel="stylesheet" href="style.css">
    <!--
    Use cases
    =========
    1. List the bugs - done
    2. Add a new bug - done
    3. Toggle the 'closed' status of a bug (use ng-class) - done
    4. Remove Closed bugs - done
    5. Display stats - (partially done)
    6. Search for the bugs
    7. Sort the bugs
    8. Display the "createdAt"
    9. Persist the bugs in the storage
    10. Make the storage option (localStorage or sessionStorage) configurable
    11. Persist the bugs in the server
    12. Enable routing
    13. Add 'project' support

    -->
    <script src="angular.js"></script>
    <script>
        var bugTrackerApp = angular.module("bugTrackerApp", []);
        bugTrackerApp.controller("bugsController", function($scope){
            $scope.bugs = [
                {name : "Stack overflow error", isClosed : false},
                {name : "Object reference not found", isClosed : true},
                {name : "Invalid operation performed", isClosed : true},
                {name : "Server communication error", isClosed : false}
            ];
            $scope.newBug = ''
            $scope.addNew = function(){
                $scope.bugs.push($scope.newBug);
                $scope.newBug = '';
            };
            $scope.toggle = function(bug){
                bug.isClosed = !bug.isClosed;
            };
            $scope.getClosedCount = function(){
                return $scope.bugs.filter(function(bug){
                    return bug.isClosed;
                }).length;
            };
            $scope.removeClosed = function(){
                for(var i=$scope.bugs.length -1; i>=0; i--){
                    if ($scope.bugs[i].isClosed){
                        $scope.bugs.splice(i,1);
                    }
                }
            };

        });
    </script>
</head>
<body ng-app="bugTrackerApp" ng-controller="bugsController">
    <h1>Bug Tracker</h1>
    <div class="stats" ><span class="closed">{{getClosedCount()}}</span> / <span>{{bugs.length}}</span></div>
    <div class="search">
        <label for="">Search :</label>
        <input type="text" ng-model="searchBug.name">
        <label for="">Closed ?</label>
        <input type="checkbox" ng-model="searchBug.isClosed" >
        <a href="#" ng-click="searchBug.isClosed = undefined">Show All</a>
    </div>
    <div class="Order">
        <label for="">Order By:</label>
        <!--<input type="text" ng-model="sortBugBy.attrName">-->
        <select ng-model="sortBugBy.attrName">
            <option value="name">name</option>
            <option value="isClosed">isClosed</option>
        </select>
        <label for="">Descending ? :</label>
        <input type="checkbox" name="" id="" ng-model="sortBugBy.descending">
    </div>
    <div class="content">
        <label for="">Bug :</label>
        <input type="text" name="" id="" ng-model="newBug">
        <input type="button" value="Add New" ng-click="addNew()">
        <input type="button" value="Remove Closed" ng-click="removeClosed()">
        <ol>
            <li
                ng-repeat="bug in bugs | filter:searchBug | orderBy:sortBugBy.attrName: sortBugBy.descending"
                ng-click="toggle(bug)"
                ng-class="{closed : bug.isClosed}"
                >{{bug.name | lowercase}}</li>
        </ol>
    </div>
</body>
</html>
